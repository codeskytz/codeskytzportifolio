"use strict";(()=>{var e={};e.id=13,e.ids=[13],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1017:e=>{e.exports=require("path")},2541:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>w,originalPathname:()=>x,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>_});var n={};r.r(n),r.d(n,{GET:()=>GET,POST:()=>POST}),r(8976);var o=r(884),a=r(6132);let s=require("fs");var i=r.n(s),u=r(1017),c=r.n(u),d=r(5798),m=r(7163);let l=c().join(process.cwd(),"data","comments.json");function readComments(){try{return JSON.parse(i().readFileSync(l,"utf-8"))}catch(e){return[]}}async function GET(){let e=readComments();return d.Z.json({data:e})}async function POST(e){let t=await e.json(),{name:r,email:n,rating:o,comment:a}=t;if(!r||!n||!a)return d.Z.json({error:"Missing fields"},{status:400});let s=(0,m.h)("comments-"+(e.headers.get("x-forwarded-for")||"anon"),50,60);if(s.limited)return d.Z.json({error:"Too many requests"},{status:429});let u=readComments(),c={id:`c_${Date.now()}`,name:r,email:n,rating:o||5,comment:a,date:new Date().toISOString().slice(0,10)};u.unshift(c);try{i().writeFileSync(l,JSON.stringify(u,null,2))}catch(e){console.error(e)}return d.Z.json({data:c},{status:201})}let p=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/comments/route",pathname:"/api/comments",filename:"route",bundlePath:"app/api/comments/route"},resolvedPagePath:"/workspaces/codeskytzportifolio/app/api/comments/route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:h,headerHooks:w,staticGenerationBailout:_}=p,x="/api/comments/route"},7163:(e,t,r)=>{r.d(t,{h:()=>rateLimit});let n=new Map;function rateLimit(e,t,r){let o=Date.now(),a=n.get(e)||{count:0,reset:o+r};return o>a.reset?(a.count=1,a.reset=o+r):a.count++,n.set(e,a),{limited:a.count>t,remaining:Math.max(0,t-a.count),reset:a.reset}}}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[955],()=>__webpack_exec__(2541));module.exports=r})();