(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[345],{7673:function(e,t,a){Promise.resolve().then(a.bind(a,8009))},8009:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return NewProject}});var l=a(7437),r=a(2265),o=a(994),n=a(4086),i=a(9584);let s=(0,o.ZF)({apiKey:"AIzaSyCnzXi1tVu3fWvuPMffaepqT74DXEb8wWk",authDomain:"codeskytz-portifolio.firebaseapp.com",projectId:"codeskytz-portifolio",storageBucket:"codeskytz-portifolio.firebasestorage.app",messagingSenderId:"658801980297",appId:"1:658801980297:web:3df9f01e5641120d81e758",measurementId:"G-0RHE2PZ3FL"}),d=(0,n.ad)(s);function NewProject(){let[e,t]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[i,s]=(0,r.useState)(["React","Next.js","Tailwind"]),[c,u]=(0,r.useState)([]),[p,f]=(0,r.useState)(null),[m,h]=(0,r.useState)(null),[g,b]=(0,r.useState)([]),[y,x]=(0,r.useState)([]),[w,v]=(0,r.useState)(""),[j,N]=(0,r.useState)(!1),S="8a402848056a5c86e392b765263065e0",[I,k]=(0,r.useState)("");async function uploadToImgbb(e){let t;if(!S)throw Error("IMGBB API key not configured. Set NEXT_PUBLIC_IMGBB_API in your environment.");let a=new FormData;if(a.append("key",S),e&&"object"==typeof e&&e instanceof File)a.append("image",e);else if(e&&"string"==typeof e){let t=String(e).replace(/^data:.*;base64,/,"").replace(/\s+/g,""),l=/^[A-Za-z0-9+/]+=*$/.test(t);if(!l)throw Error("Invalid base64 data for image. Consider using a direct file upload.");a.append("image",t)}else throw Error("Can't get target upload source info");let l=await fetch("https://api.imgbb.com/1/upload",{method:"POST",body:a});try{t=await l.json()}catch(e){throw Error("Invalid response from imgbb")}if(!l.ok||!t||!t.data||!t.data.url){var r;let e=(null==t?void 0:null===(r=t.error)||void 0===r?void 0:r.message)||(null==t?void 0:t.status_message)||JSON.stringify(t)||"Upload failed";throw Error(e)}return t.data.url}async function submit(l){if(l.preventDefault(),!e)return alert("Title required");N(!0),k("");try{let l="";if(m)try{l=await uploadToImgbb(m)}catch(e){if(p)l=await uploadToImgbb(p);else throw e}else p&&(l=await uploadToImgbb(p));let r=[],i=Math.max(g.length,y.length);for(let e=0;e<i;e++){let t=g[e],a=y[e];if(a)try{r.push(await uploadToImgbb(a));continue}catch(e){if(t){r.push(await uploadToImgbb(t));continue}throw e}if(t)try{r.push(await uploadToImgbb(t));continue}catch(t){throw Error("Failed to upload gallery image #".concat(e+1,": ").concat((null==t?void 0:t.message)||t))}console.warn("Skipping gallery index ".concat(e," - no file or base64 data available"))}await (0,n.ET)((0,n.hJ)(d,"projects"),{title:e,summary:a,techs:c,front:l,gallery:r,live:w,createdAt:(0,n.Bt)()}),alert("Project created"),t(""),o(""),u([]),f(null),b([]),v("")}catch(t){console.error(t);let e=(null==t?void 0:t.message)||String(t);k(e),alert("Failed: "+e)}finally{N(!1)}}function toBase64(e){return new Promise((t,a)=>{let l=new FileReader;l.onload=()=>t(l.result),l.onerror=a,l.readAsDataURL(e)})}async function handleFront(e){let t=e.target.files[0];if(!t)return;let a=await toBase64(t);f(a),h(t)}async function handleGallery(e){let t=Array.from(e.target.files),a=[];for(let e of t)a.push(await toBase64(e));b(a),x(t)}return(0,l.jsxs)("div",{className:"p-6 max-w-3xl mx-auto",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold",children:"Create Project"}),(0,l.jsxs)("form",{onSubmit:submit,className:"mt-4 space-y-4",children:[(0,l.jsx)("input",{value:e,onChange:e=>t(e.target.value),placeholder:"Title",className:"w-full p-2 border rounded"}),(0,l.jsx)("textarea",{value:a,onChange:e=>o(e.target.value),placeholder:"Short summary",className:"w-full p-2 border rounded"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-2",children:"Techs (click to toggle)"}),(0,l.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[i.map(e=>(0,l.jsx)("button",{type:"button",onClick:()=>{u(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:"px-3 py-1 rounded ".concat(c.includes(e)?"bg-indigo-600 text-white":"bg-gray-100"),children:e},e)),(0,l.jsx)("input",{placeholder:"Add tech",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),s(t=>[...t,e.target.value]),e.target.value="")},className:"px-3 py-1 border rounded"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm",children:"Front image"}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:handleFront})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm",children:"Gallery images"}),(0,l.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:handleGallery})]}),(0,l.jsx)("input",{value:w,onChange:e=>v(e.target.value),placeholder:"Live URL",className:"w-full p-2 border rounded"}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{type:"submit",disabled:j,className:"px-4 py-2 rounded bg-indigo-600 text-white",children:j?"Uploading...":"Create"})})]})]})}(0,i.cF)(s)}},function(e){e.O(0,[358,919,971,472,744],function(){return e(e.s=7673)}),_N_E=e.O()}]);